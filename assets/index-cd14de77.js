(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const g="modulepreload",h=function(e){return"/pqkms-web/"+e},d={},f=function(t,s,o){if(!s||s.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(s.map(n=>{if(n=h(n),n in d)return;d[n]=!0;const i=n.endsWith(".css"),m=i?'[rel="stylesheet"]':"";if(!!o)for(let c=r.length-1;c>=0;c--){const l=r[c];if(l.href===n&&(!i||l.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${m}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":g,i||(a.as="script",a.crossOrigin=""),a.href=n,document.head.appendChild(a),i)return new Promise((c,l)=>{a.addEventListener("load",c),a.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t()).catch(n=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n})};async function p(e,t,s,o,r){return(await f(()=>import("./registration-5de5c93b.js"),["assets/registration-5de5c93b.js","assets/auth_base-0ccf5998.js"])).register_user(e,t,s,o,r)}async function _(e,t){const s=await f(()=>import("./login-846b1961.js"),["assets/login-846b1961.js","assets/auth_base-0ccf5998.js"]),o=`https://${e.access_url}`;return s.login_user(e.domain_name,e.user_name,t,e.salt,e.auth_algo,o)}async function y(e,t){let s=`${e}/v0/admin/user_info?user_name=${t}`;const o=await fetch(s,{mode:"cors",cache:"no-store"});if(o.ok)return(await o.json()).message;{const r=await o.json();throw new Error(`Server error: ${r.code} => ${r.message}`)}}async function v(e){let t=new FormData(e),s=t.get("domain"),o=t.get("email"),r=t.get("password");return p(s.trim(),o.trim(),r,"https://registrar.pqkms.dev:8443")}async function w(e){let t=new FormData(e),s=t.get("email"),o=t.get("password"),r=await y("https://registrar.pqkms.dev:8443",s.trim());_(r[0],o)}function E(){return document.querySelector("body > div.registration")}function L(){let e=document.querySelector("body > div.registration > div.read-the-docs");if(e)return e;{let t=E();if(t){let s=document.createElement("div");return t.appendChild(s),s}else return null}}function u(e){let t=L();t&&(t.innerText=e)}const R=e=>{e.preventDefault(),e.currentTarget?v(e.currentTarget).then(u).catch(t=>{u(`Registration failed: ${t.message}`)}):u("Invalid event target for registration form")},S=e=>{e.preventDefault(),e.currentTarget?w(e.currentTarget).catch(t=>{alert(`Login failed: ${t}`)}):alert("Invalid event target for registration form")},b=()=>{const e=document.querySelector("body > div.registration > form"),t=document.querySelector("body > div.login > form");e&&e.addEventListener("submit",R),t&&t.addEventListener("submit",S)};b();
